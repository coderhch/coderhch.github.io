---
title: DOM
tags: 
    - JavaScript
    - 前端
    - 笔记
cover: https://coderhch.oss-cn-shanghai.aliyuncs.com/blog/2021-04-24/DOM/2.jpg
date: 2021-04-24
---
# DOM

## 访问元素节点

### 认识document对象

- document对象是DOM中最重要的的东西，几乎	所有DOM的功能都封装在了document对象中
- document对象也表示整个HTML文档，它是DOM节点数的根
- document对象的nodeType属性值是9

### 访问元素节点的常用方法

|               方法                |            功能            | 兼容性  |
| :-------------------------------: | :------------------------: | ------- |
|     document.getElementById()     |     通过**id**得到元素     | IE6     |
|  document.getElementsByTagName()  | 通过**标签名**得到元素数组 | IE6     |
| document.getElementsByClassName() |  通过**类名**得到元素数组  | IE9     |
|     document.querySelecctor()     |   通过**选择器**得到元素   | IE8 IE9 |
|    document.querySelectorAll()    | 通过**选择器**得到元素数组 | IE8 IE9 |

### 节点的关系

|      关系      |  考虑所有节点   |     只考虑元素节点     |
| :------------: | :-------------: | :--------------------: |
|     子节点     |   childNodes    |        children        |
|     父节点     |   parentNode    |       parentNode       |
|  第一个子节点  |   firstChild    |   firstElementChild    |
| 最后一个子节点 |    lastChild    |    lastElementChild    |
| 前一个兄弟节点 | previousSibling | previousElementSibling |
| 后一个兄弟节点 |   nextSibling   |   nextElementSibling   |

### 节点创建、移动、移除与克隆

#### 创建

|                 方法                  | 描述                       |
| :-----------------------------------: | -------------------------- |
|       document.createElement()        | 创建一个指定的html元素节点 |
|       父节点.appendChild(节点)        | 追加到父节点下最后一个节点 |
| 节点.insertBefore(孤儿节点，标杆节点) | 插入到父节点下标杆节点前面 |

#### 移除

如果将已经挂载到DOM树上的节点成为`appendChild()`或者`insertBefore()`的参数，这个节点将会被移动

#### 删除

|                方法                |        描述         |
| :--------------------------------: | :-----------------: |
| 父节点.removeChild(要删除的子节点) | 从DOM中删除一个节点 |

#### 克隆

|              方法               |   描述   |
| :-----------------------------: | :------: |
| var 孤儿节点=老节点.cloneNade() | 克隆节点 |



## 事件监听

### 常见的鼠标事件

|    事件名    |                              |
| :----------: | ---------------------------- |
|   onclick    | 当鼠标单击某个对象           |
|  ondblclick  | 当鼠标双击某个对象           |
| onmousedown  | 当鼠标按键在某个对象上被按下 |
|  onmouseup   | 当鼠标按键在某个对象上松开   |
| onmousemove  | 当鼠标按键在某个对象上被移动 |
| onmouseenter | 当鼠标进入某个对象           |
| onmouseleave | 当鼠标离开某个对象           |

### 常见的键盘事件

|   事件名   |                   事件描述                   |
| :--------: | :------------------------------------------: |
| onkeypress | 当某个键盘的键被按下（系统按钮无法得到识别） |
| onkeydown  |    当某个键盘的键被按下（系统按钮可识别）    |
|  onkeyup   |             当某个键盘的键被松开             |

### 常见的表单事件

|  事件名  |      事件描述      |
| :------: | :----------------: |
| onchange | 当用户改变域的内容 |
| onfocus  |  当某元素获得焦点  |
|  onblur  |  当某元素失去焦点  |
| onsubmit |    当表单被提交    |
| onreset  |    当表单被重置    |

## 事件传播

问题：当盒子嵌套时事件监听的执行顺序

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #box1{
            width: 202px;
            height: 202px;
            border: 1px solid #000;
            padding: 50px;
        }
        #box2{
            width: 100px;
            height: 100px;
            border: 1px solid #000;
            padding: 50px;
        }
        #box3{
            width: 100px;
            height: 100px;
            border: 1px solid #000;
        }
    </style>
</head>
<body>
    <div id="box1">
        <div id="box2">
            <div id="box3"></div>
        </div>
    </div>
    <script>
        var oBox1 = document.getElementById('box1');
        var oBox2 = document.getElementById('box2');
        var oBox3 = document.getElementById('box3');

        oBox2.onclick = function () {
            console.log('我是box2的onclick');
        };

        oBox3.onclick = function () {
            console.log('我是box3的onclick');
        };

        oBox1.onclick = function () {
            console.log('我是box1的onclick');
        };
    </script>
</body>
</html>
```

<img src="https://coderhch.oss-cn-shanghai.aliyuncs.com/blog/2021-04-24/DOM/1.jpg" style="zoom:50%;" />

实际上事件的传播是：先从外到内，然后再从内到外。从外到内叫做**捕获阶段**（capturing phase）从内到外叫做**冒泡阶段**（Bubbling phase）。为什么点击盒子会冲box3开始触发呢，因为onxxx写法只能监听冒泡阶段。要监听捕获阶段就要用`addEventListener()`函数。

DOM2级事件监听：

```javascript
oBox.addEventListener('click',funcation(){

},true)//第三个参数为true监听捕获阶段false监听冒泡阶段
```

## 事件对象

事件处理行数提供一个形式参数，它是一个对象，封装了本次事件的细节。

|   属性和方法    | 类型 |                           属性描述                           |
| :-------------: | ---- | :----------------------------------------------------------: |
|     clientX     | 属性 |                鼠标指针相对于浏览器的水平坐标                |
|     clientY     | 属性 |                鼠标指针相对于浏览器的垂直坐标                |
|      pageX      | 属性 |               鼠标指针相对于整张网页的水平坐标               |
|      pageY      | 属性 |               鼠标指针相对于整张网页的垂直坐标               |
|     offsetX     | 属性 |              鼠标指针相对于事件源元素的水平坐标              |
|     offsetY     | 属性 |              鼠标指针相对于事件源元素的垂直坐标              |
|    charCodes    | 属性 |     通常用于onkeypress事件中，表示用户输入字符的“字符码”     |
|     keyCode     | 属性 | 通常用于onkeydown事件和onkeyup中，表示用户按下的按键的"键码" |
| preventDefault  | 方法 |                     阻止事件产生默认动作                     |
| stopPropagation | 方法 |                       阻止事件继续传播                       |

### charCode字符码

| 字符 | 字符码 |
| :--: | :----: |
| 0-9  | 48~57  |
| A-Z  | 65~90  |
| a-z  | 97~122 |

### keyCode键码

|  按键   |      键码      |
| :-----: | :------------: |
|   0-9   |     48~57      |
|   a-z   |     65~90      |
| ← ↑ → ↓ | 37、38、39、40 |
| 回车键  |       13       |
| 空格键  |       32       |

## 事件委托

利用事件冒泡机制，将后代元素事件委托给祖先元素

| 属性          | 属性描述                           |
| ------------- | ---------------------------------- |
| target        | 触发此事件的最早元素即“事件源元素” |
| currentTarget | 事件处理程序附加到的元素           |

## 定时器延时器

### 定时器

```javascript
let timer = setInterval(funcation(){

},2000)
clearInterval(timer)
```

### 延时器

```javascript
let timer = setTimeout(funcation(){

},2000)
clearTimeout(timer)
```

