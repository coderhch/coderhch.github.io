---
title: 跨域与防盗链
tags:
  - nginx
  - 运维
cover: https://coderhch.oss-cn-shanghai.aliyuncs.com/blog/2021-06-05/%E8%B7%A8%E5%9F%9F%E4%B8%8E%E9%98%B2%E7%9B%97%E9%93%BE/72727291_p0.jpg
date: 2021-06-05
categories: nginx
---

# 跨域与防盗链

## 跨域

```
server {
	add_header 'Access-Control-Allow-Origin' *;
	add_header 'Access-Control-Allow-Credentials' 'true';
	add_header 'Access-Control-Allow-Methods' *;
	add_header 'Access-Control-Allow-Headers' *;
}
```

### 描述

1. 'Access-Control-Allow-Origin' \*

   允许跨域请求的域，\*代表所有

2. 'Access-Control-Allow-Credentials' 'true'

   允许带上 cookie 请求

3. 'Access-Control-Allow-Methods' \*

   允许请求的方法，比如 GET/POST/PUT/DELETE

4. 'Access-Control-Allow-Headers' \*

   允许请求的 header

## 防盗链

```
server{
	#对源站点验证
	valid_referers *.imooc.com;
	#非法引入会进入下方判断
	if ($invalid_referer) {
    	return 404;
    }
}
```

### 描述

`valid_referers *.imooc.com`表示请求的域名必须以**\*.imooc.com**,如果不是就会返回 404
